La variante óptima del algoritmo iterativo para A y B en el diseño de fila-principal es una de azulejos versión, donde la matriz está implícitamente divide en azulejos cuadrados de tamaño √ M por √ M :

	Entrada: matrices A y B
	Deje C ser una nueva matriz del tamaño apropiado
	Elija un tamaño de mosaico T = Θ ( √ M )
	Para I de 1 a n en pasos de T :
		Para J de 1 a p en pasos de T :
			Para K de 1 a m en pasos de T :
				Multiplicar A I : I + T , K : K + T y B K : K + T , J : J + T en C I : I + T , J : J + T , que es:
				Para i de I a MIN ( I + T , n ) :
					Para j de J a min ( J + T , p ) :
						Deje suma = 0
						Para k de K a min ( K + T , m ) :
							Establecer suma ← suma + A ik × B kJ
						Set C ij ← C ij + suma
	Volver C
